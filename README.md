<h1>Tracing Malicious Activity in Windows OS</h1>

<h2>Brief Description</h2>
<p>The desktop PC under investigation was seized from a suspect suspected of utilizing the PlagueRat commodity malware to target an IT services company. A forensic disk copy has been captured, and the analysis aims to determine if PlagueRat was employed. Specific questions guide the investigation, including identifying the full file name of PlagueRat, details about its ZIP file, and examining the contents within. Additional inquiries involve analyzing the PlagueRat process in prefetch files and exploring the user's Jump List to determine accessed websites and the associated browser.

This project provides a practical scenario for digital forensics professionals to uncover critical evidence, aiding in the conviction of a malicious hacker. The investigation delves into multiple aspects of system artifacts, showcasing the utilization of advanced tools and methodologies to achieve a comprehensive understanding of the suspect's activities.</p>

<h2>Project Walk-Through</h2>
<br/>
<p align="center">
    <img src="https://imgur.com/FGCS8us.png" height="80%" width="80%" alt="Project Overview Image">
</p>
<br/>
<h2>Utilities Used</h2>
<ul>
    <li><b>Windows File Analyzer</b> - https://www.mitec.cz/wfa.html</li>
    <li><b>PECmd - Eric Zimmerman's tools</b></li>
    <li><b>JumpList Explorer - Eric Zimmerman's tools</b></li>
</ul>

<h3>Analyze .LNK files in Shortcuts folder w/ Windows File Analyzer</h3>
<p>Full file path of PlageRat file </p>
<img src="https://imgur.com/ByceLRL.png" height="80%" width="80%" alt="FTK Imager Memory Capture">
<h3> Identify ZIP files containing PlagueRat </h3>
<br/>
<img src="https://imgur.com/qt8dZ9b.png" height="80%" width="80%" alt="ProcDump Directory Change">
2020_Summer_Photos, Invoice
<h3> Analyze CMD.exe-89305D47.pf in PlagueRat file using PECmd.exe</h3>
Go to Prefetch files directory and view running programs
<br/>
<img src="https://imgur.com/QYJ7Q2F.png" height="80%" width="80%" alt="ProcDump Directory Change">
Analyze Prefetch files using PECmd.exe
<br/>
<code>PECmd.exe -f "C:\Users\BTLOTest\Desktop\Windows Investigation One\Prefetch\CMD.EXE-89305D47.pf" </code>
<br/>
<br/>
<img src="https://imgur.com/JjX9HJZ.png" height="80%" width="80%" alt="ProcDump Directory Change">
<br/>
<p>Full file name and path of PlagueRAT in CMD.EXE-89305D47 </p>
<img src="https://imgur.com/PCd3sT7.png" height="80%" width="80%" alt="ProcDump Directory Change">
<h3> Cross-Reference the prefetch files from PlagueRat.ps1 from earlier</h3>
This will open all .pf files asssociated with the string "plaguerat.ps1"
<br/>
Command => <code> PECmd.exe -k “plaguerat.ps1” -d "C:\Users\BTLOTest\Desktop\Windows Investigation One\Prefetch\" </code>
<br/>
<br/>
1 of 2 Applications used: Notepad.exe
<img src="https://imgur.com/OBgo8lB.png" height="80%" width="80%" alt="ProcDump Directory Change">
<img src="https://imgur.com/M5hwcPY.png" height="80%" width="80%" alt="ProcDump Directory Change">
Files Referenced: 
<img src="https://imgur.com/gu9vfNt.png" height="80%" width="80%" alt="ProcDump Directory Change">
<br/>
2 of 2 Applications used: Powershell.exe
<br/>
<img src="https://imgur.com/p9LrckB.png" height="80%" width="80%" alt="ProcDump Directory Change">
<br/>
Files Referenced:
<br/>
<img src="https://imgur.com/JK9mpEu.png" height="80%" width="80%" alt="ProcDump Directory Change">








<br/>
<p>Get Process ID (PID) for the calculator application</p>
<br/>
<p>Shell command: <code>Get-Process | findstr -I calc</code></p>
<br/>
<p>Results Output: PID = 4420</p>
<br/>
<img src="https://imgur.com/ABxLoZm.png" height="80%" width="80%" alt="PID Results Output">
<br/>
<br/>
<p>After retrieving PID, use ProcDump to create a full memory dump of this process using:</p>
<br/>
<p>Command: <code>.\procdump.exe -ma 4420</code></p>
<br/>
<img src="https://imgur.com/K1zVv80.png" height="80%" width="80%" alt="ProcDump Memory Dump">
<br/>
<br/>
<p>In an incident response engagement, we can use these utilities to capture the image of Malware running on a system.
<br/>
<br/>
<h3>Collecting Disk Image using FTK Imager</h3>
<br/>
<p>Open FTK Imager: Go to File > Create Disk Image > Select Source from Physical Drive</p>
<br/>
<img src="https://imgur.com/liZWHGq.png" height="80%" width="80%" alt="FTK Imager Disk Image Creation">
<br/>
<br/>
<p>Select a Drive input</p>
<br/>
<br/>
<img src="https://imgur.com/Zxb4QuC.png" height="80%" width="80%" alt="Drive Input Selection">
<br/>
<br/>
<p>Create Image - Select the output destination for the file. Click Add and change the format type to a .E01 file. This filetype is used by analysis tools, such as the enterprise-grade forensics triage software EnCase.</p>
<br/>
<img src="https://imgur.com/MVLtw1f.png" height="80%" width="80%" alt="FTK Imager Disk Image Output">
<br/>
<br/>
<p>Select Output location and filename:</p>
<br/>
<img src="https://imgur.com/7o9Ijn0.png" height="80%" width="80%" alt="Output Location and Filename">
<br/>
<img src="https://imgur.com/eywXn2y.png" height="80%" width="80%" alt="Output Location and Filename 2">
<br/>
<p>Once the disk image is complete, FTK Imager will provide us with hash values for integrity purposes.</p>
<!-- Add additional content as needed -->

</body>
</html>
<p>So we can ensure that the disk image or any copies are the exact same as when it was acquired. This allows us to prove or disprove claims of data corruption or tampering.</p>
<br/>
<img src="https://imgur.com/yXysp7b.png" height="80%" width="80%" alt="FTK Imager Disk Image Hash Values">
<br/>
<br/>
<h3>Live Acquisition - Remote KAPE</h3>
<br/>
<p>Copy and Paste the KAPE Application from Host to Guest workstation via a RDP connection</p>
<br/>
<img src="https://imgur.com/8ImXICP.png" height="80%" width="80%" alt="FTK Imager Disk Image Creation">
<br/>
<br/>
<p>Open KAPE on Guest workstation, Config target options, source, destination and items then > Execute </p>
<br/>
<br/>
<img src="https://imgur.com/3DPZY6Q.png" height="80%" width="80%" alt="Drive Input Selection">
<br/>
<br/>
<p>Exfiltrate Kape output from guest workstation to host workstation and analyze results.</p>
<br/>
<img src="https://imgur.com/Irq3N53.png" height="80%" width="80%" alt="FTK Imager Disk Image Output">
<br/>
<br/>
<!-- Add additional sections or content as needed -->

<h2>Conclusion</h2>
<p>In conclusion, the use of industry-standard tools such as FTK Imager, Sysinternals, and KAPE facilitates efficient and effective digital data acquisition for forensic purposes. The adherence to critical data integrity methodologies, including the Order of Volatility and Chain of Custody, ensures the reliability and admissibility of the acquired evidence in legal proceedings.</p>

<p>This project walkthrough provides a comprehensive guide to collecting memory dumps and disk images, crucial steps in investigating and responding to incidents involving potentially compromised workstations.</p>
